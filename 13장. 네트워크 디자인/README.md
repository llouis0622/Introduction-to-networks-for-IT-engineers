# 13장. 네트워크 디자인

# 1. 2계층 / 3계층 네트워크

## 1. 2계층 네트워크

- 호스트 간 통신이 직접 2계층 통신만으로 이루어지는 네트워크 디자인
- 동일한 네트워크
- 게이트웨이를 거치지 않고 직접 호스트 간 통신 가능
- 루프 구조 → 문제 발생 → 스패닝 트리 프로토콜을 사용해 문제 해결
- 블록 포인트가 생기면서 전체 인프라의 대역폭을 사용하지 못하는 문제 발생
- 논블로킹 구조 : MC-LAG으로 루프 제거

## 2. 3계층 네트워크

- 호스트 간 통신이 IP 라우팅과 같은 3계층 통신으로 이루어지는 네트워크 디자인
- 루프 문제 미발생
- ECMP(Equal-Cost Multi-Path) 라우팅 기술
- 네트워크 장비 연결마다 다른 네트워크를 가지고 네트워크에 연결되어 있는 단말도 다른 네트워크 장비에 연결되어 있다면 다른 네트워크 보유
- VxLAN : 하단 호스트 간에 동일한 네트워크를 사용하면서도 네트워크 장비 간에 3계층 통신 가능, 터널링 프로토콜 기반

# 2. 3-Tier 아키텍쳐

- 코어(Core) - 애그리게이션(Aggregation) - 액세스(Access)
- 상위 레이어로 올라갈수록 장비들이 집선 → 높은 대역폭 필요
- 업링크에서는 오버서브스크립션 비율(Oversubscription Ratio)를 산정
- 서버 간 통신보다 사용자로부터 서비스를 요청받고 서버에서 사용자의 요청에 응답하는 North-South 트래픽이 대부분일 때 적합

# 3. 2-Tier 아키텍쳐

## 1. 스파인 - 리프 구조

- 하단 호스트가 연결되는 리프 스위치는 상단 스파인 스위치와 연결
- 모든 링크를 사용해 트래픽 전송
- 출발지 리프 스위치를 지나 스파인 스위치를 거쳐 목적지 리프 스위치로 트래픽이 흘러 네트워크 흐름에 대한 홉 수가 짧아지고 트래픽 흐름 일정

## 💭. East-West 트래픽

- 서버 가상화 : 동일한 네트워크에 속한 서버들이 하나의 리프 스위치에 연결되지 않고 다양한 스위치에 연결
- 빅데이터 대중화 : 분산 처리 → 컨트롤 노드와 데이터 저장 노드로 분리, 서버 간 통신 증가
- 애플리케이션 아키텍쳐와 개발 방법 변화 : MSA(Micro Service Architecture)

## 2. L2 패브릭

- 스파인과 리프 사이를 2계층 네트워크로 구성
- TRILL(TRansparent Interconnection of Lots of Links)
- SPB(Shortest Path Bridging)

## 3. L3 패브릭

- 스파인과 리프 사이를 3계층 네트워크로 구성
- 각각 라우팅이 활성화, 일반적인 라우팅 프로토콜을 이용해 경로 정보 교한
- 루프 제거, ECMP를 통해 모든 링크 사용 가능

# 4. 데이터 센서 Zone / PoD 내부망 / DMZ망 / 인터넷망

## 1. 인터넷망

- 인터넷에서 사용자가 데이터 센서에 접근할 수 있도록 구성된 영역
- ISP(Internet Service Provider)에서 IP 할당
- BGP 프로토콜 이용, 별도의 AS(Autonomous System) 번호 보유

## 2. 공인망(DMZ)

- 외부 사용자에게 직접 노출되는 웹 서비스 등의 서버들이 모인 망
- 외부 접근을 위해 공인 IP 사용
- 서비스를 외부로 제공
- 데이터 센터 내부망의 연결 지점 역할

## 3. 내부망(사내망 / 사설망)

- 데이터 센터 내부나 사내에서만 접근할 수 있는 네트워크
- 인터넷을 통한 외부망에서는 직접 접근 불가
- 외부망과 통신할 때는 사설 IP로 통신 불가 → 외부망으로 나가려면 중간에 공인 IP로 변환해주는 NAT 필요

## 4. 데이터베이스망

- 개인정보를 취급하는 경우 → 보안을 강화하기 위해 내부망에 설치
- 내부망에서 접근할 때 추가로 방화벽을 두고 별도 망 구성 가능
- 접근 통제 시스템 운영

## 5. 대외망

- 별도 전용선이나 VPN을 이용해 서비스 연동
- 서비스에 필요한 최소한의 접근만 허용

## 6. 관리망 / OoB(Out of Band)

- 장비 자체를 관리하기 위한 관리용 인터페이스를 별도로 제공
- 서비스망에 문제가 발생하더라도 서비스망과 별도로 분리된 관리망을 통해 장비 접근
- 콘솔 접근 가능 → 기본적으로 하드웨어 자체를 관리

# 5. 케이블링과 네트워크

## 1. ToR(Top of Rack)

- 랙 상단에 개별적으로 설치되는 스위치 구성
- 랙 안에 서버들을 직접 연결하고 상단 네트워크 장비는 별도의 네트워크 랙에 구성되어 서로 연결

## 2. EoR(End of Row)

- 랙이 있는 행 끝에 네트워크 장비를 두고 각 랙에 있는 서버는 네트워크 장비가 있는 랙까지 케이블로 연결
- 서버가 있는 랙과 네트워크 장비가 있는 랙을 분리한 구성

## 3. MoR(Middle of Row)

- EoR과 마찬가지로 서버에 연결된 네트워크 장비 랙을 별도로 구성하는 점은 동일
- 네트워크 장비 랙을 행 끝이 아닌 중간에 두는 경우
